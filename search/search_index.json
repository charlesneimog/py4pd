{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Introduction","text":"<p> Welcome to the <code>py4pd</code> documentation! </p> <p> </p>"},{"location":"#what-is-py4pd","title":"What is py4pd?","text":"<p><code>py4pd</code> bridges the capabilities of OpenMusic with the versatility of PureData. If you're familiar with OpenMusic and BachLibrary, you'll discover a fresh source of inspiration here.</p> <p>We achieve this by using Python instead of OpenMusic's Common Lisp, unlocking a vast array of powerful tools developed by composers and artists. This approach makes it easier to create music while seamlessly integrating extra code when needed.</p>"},{"location":"#puredata-user","title":"PureData User","text":"<ul> <li> <p> Algorithm Composition </p> <p> List</p> </li> <li> <p> <code>py4pd</code> Libraries</p> <p> Libraries</p> </li> </ul>"},{"location":"#python-user","title":"Python User","text":"<ul> <li> <p> Hello World </p> <p> Hello World with <code>py4pd</code></p> </li> <li> <p> Creating Libraries</p> <p> Creating Pd Object with Python</p> </li> </ul> <p>How to install?</p> <p>To check how to install go to Installation.</p>"},{"location":"#examples-and-use-cases","title":"Examples and Use Cases","text":"<p>Here are presented tools implemented with <code>py4pd</code>. Users are encouraged to contribute their examples through Github .</p> AI TrainingArtificial Inteligence <p>With <code>py4pd</code>, you can train an AI using Pd, an share ways to train with composers, students, and others.</p> <p> </p> <p>It is easy to use <code>AI</code> with <code>py4pd</code>. There are already powerful objects for real-time, like <code>nn~</code> and <code>ddsp~</code>, but they are designed to specify approaches. Below is an example using <code>py4pd</code> and the Python code used by <code>nn~</code> (offline processing).</p> <p><p> </p></p> <p><p>          Your browser does not support the audio element.      </p></p> Python Code <p>To illustrate the statement \"Python offers a more accessible and user-friendly alternative than C and C++\", presented earlier, here is an example of Python code:</p> <pre><code>import pd # py4pd library\nimport torch # Library of AI\nimport librosa # Library to load audios in Python\n\ndef renderAudio_nn(audio, model):\n    model = pd.get_patch_dir() + '/' + model # get the pathname of model.ts, which is the result of the IA trained.\n    audio = pd.get_patch_dir() + '/' +  audio # The audio source\n    torch.set_grad_enabled(False) # config of the IA\n    model = torch.jit.load(model).eval() # Load model of IA\n    x = librosa.load(audio)[0] # take the audio samples of the sound (audio)\n    x_for = torch.from_numpy(x).reshape(1, 1, -1) # transform the audio to fit in the IA model\n    z = model.encode(x_for) # the black box\n    z[:, 0] += torch.linspace(-2, 2, z.shape[-1]) # No idea;\n    y = model.decode(z).numpy().reshape(-1) # Now we have sound again!\n    pd.tabwrite('iaAudio', y.tolist(), resize=True) # Here we write the sound in the table 'iaAudio'.\n    pd.print('Audio rendered')\n</code></pre>"},{"location":"#pieces-where-i-use-it","title":"Pieces where I use it","text":"Ideias Roubadas (2024)Eco (2023)Moteto (2023) <p>Ideias Roubadas III is a work inspired by the proposal of the UPIC system, developed by Iannis Xenakis in collaboration with the Centre d'Etudes de Math\u00e9matique et Automatique Musicales (CEMAMu) in Paris. Like UPIC, this piece employs an approach that manipulates visual elements to generate music using PureData to render the audio. I employ the concept of instruments (inspired by Csound) to render the sounds. Each color represents a sound or a set of instructions for spacialization, envelope, and others. <p> </p></p> <p>Eco (2023) is the first version of one under-developing piece that uses some concepts of the composer Ricardo Thomasi in his PhD research. The idea here is to use smartphones/tablets put in the performance music stand, to make real-time <code>FFT</code> and <code>Partial Tracking</code> and then, generate scores that are played. The smartphones/tablets send data to PureData, and using <code>py4pd</code>, we generate real-time scores using <code>neoscore</code>.</p> <p><p> </p></p> <p>The piece Moteto aims to be a rereading of a medieval motet. In addition, to overlapping independent voices, we use Just Intonation structures. With the help of technology, I aim to make the piece playable, also by amateur choirs, it is available on this website: www.charlesneimog.com/moteto/. <p> </p></p>"},{"location":"hello/","title":"Hello World","text":""},{"location":"hello/#creating-a-py4pd-object","title":"Creating a <code>py4pd</code> Object","text":"<p>To define a new <code>py4pd</code> object, create a subclass of <code>puredata.NewObject</code>, name the object, and finally name the script with the name + <code>.pd_py</code>. For example, <code>pymetro.pd_py</code> for the object <code>pymetro</code>. Place the file in a place where Pd can find it. </p> <p>Don't forget to load <code>py4pd</code> first</p>"},{"location":"hello/#example","title":"Example","text":"<pre><code>import puredata as pd\n\nclass pymetro_class(pd.NewObject):\n    name: str = \"pymetro\"  # Name of the Pure Data object\n\n    def __init__(self, args):\n        self.inlets = 2    # Number of inlets\n        self.outlets = 1   # Number of outlets\n</code></pre>"},{"location":"hello/#key-points","title":"Key Points","text":"<p>The Python class name (e.g., <code>pymetro_class</code>) can be any valid class name. The name attribute determines the name of the object inside Pure Data. <code>self.inlets</code> and <code>self.outlets</code> define the number of inlets and outlets for the object. When loading this object in Pure Data, use the name attribute value (<code>pymetro</code> in this example) as the object name.</p>"},{"location":"hello/#input-and-output","title":"Input and Output","text":""},{"location":"hello/#input","title":"Input","text":"<p>The input design is inspired by the mature <code>pd-lua</code> project. For methods, use the format <code>in_&lt;inlet_number&gt;_&lt;method&gt;</code>. For example, to execute code when a <code>float</code> is received on first inlet, define a method called <code>in_0_float</code>. Pd provides predefined methods that do not require a custom selector: <code>bang</code>, <code>float</code>, <code>symbol</code>, <code>list</code>, and <code>anything</code>. You can also create custom selectors (prefixes); for instance, <code>in_0_mymethod</code> will be executed when the message <code>mymethod</code> is sent to the first inlet of the object.</p>"},{"location":"hello/#output","title":"Output","text":"<p>To produce output, use the method <code>self.out</code>. For example, <code>self.out(0, pd.SYMBOL, \"test238\")</code> sends the symbol <code>\"test238\"</code> to the firist outlet. The second argument specifies the data type, which can be <code>pd.SYMBOL</code> or <code>pd.FLOAT</code>. To output a list, use <code>pd.LIST</code> instead. To output <code>numpy.ndarray</code>, <code>class</code> and others you must use <code>pd.PYOBJECT</code>.</p> <p>To receive this <code>pd.PYOBJECT</code> you need to use the <code>PyObject</code> message, which allows you to share Python data types between <code>py4pd</code> objects. This enables the transfer of class instances, NumPy arrays, and other Python objects that are not supported by Pure Data\u2019s traditional data types.</p>"},{"location":"hello/#metronome-example","title":"Metronome Example","text":"<pre><code>import puredata as pd\n\n\nclass pymetro(pd.NewObject):\n    name: str = \"pymetro\"\n\n    def __init__(self, args):\n        self.inlets = 2\n        self.outlets = 1\n        self.toggle = False\n        if len(args) &gt; 0:\n            self.time = float(args[0])\n        else:\n            self.time = 1000\n        self.metro = pd.new_clock(self, self.tick)\n        self.args = args\n\n    def in_1_float(self, f: float):\n        self.time = f\n\n    def in_0_float(self, f: float):\n        if f:\n            self.toggle = True\n            self.tick()\n        else:\n            self.metro.unset()\n            self.toggle = False\n\n    def tick(self):\n        if self.toggle:\n            self.metro.delay(self.time)\n        self.out(0, pd.SYMBOL, \"test238\")\n</code></pre>"},{"location":"hello/#oscillator-example","title":"Oscillator Example","text":"<p>This is a simple oscillator example</p> <pre><code>import puredata as pd\nimport math\n\n\nclass pytest_tilde(pd.NewObject):\n    name: str = \"pytest~\"\n\n    def __init__(self, args):\n        self.inlets = pd.SIGNAL\n        self.outlets = pd.SIGNAL\n        self.phase = 0\n\n    def perform(self, input):\n        blocksize = self.blocksize\n        samplerate = self.samplerate\n\n        out_buffer = []\n        for i in range(blocksize):\n            phase_increment = 2 * math.pi * input[0][i] / samplerate\n            sample = math.sin(self.phase)\n            out_buffer.append(sample)\n            self.phase += phase_increment\n            if self.phase &gt; 2 * math.pi:\n                self.phase -= 2 * math.pi\n        out_tuple = tuple(out_buffer)\n        return out_tuple\n\n    def dsp(self, sr, blocksize, inchans):\n        self.samplerate = sr\n        self.blocksize = blocksize\n        self.inchans = inchans\n        return True\n</code></pre>"},{"location":"hello/#train-ai-example","title":"Train AI Example","text":"<p>This is a complex and complet example to train AI using objects from <code>timbreLIBId</code>. This use <code>threading</code> to avoid block the Pd audio thread.</p> <pre><code>import puredata as pd\n\nimport os\nimport random\nimport threading\nimport numpy as np\nimport librosa\n\nfrom sklearn.metrics import classification_report\nfrom catboost import CatBoostClassifier\n\n\nclass pytrain(pd.NewObject):\n    name = \"py.train\"\n\n    def __init__(self, args):\n        # pd\n        self.inlets = 2\n        self.outlets = 2\n        self.tabname = \"train\"\n        self.redraw_tab_after = 120\n\n        # train parameters\n        self.max_offset = 256\n        self.n_windows = 10\n        self.iterations = 150\n        self.fn_estimators = 150\n        self.random_state = 42\n        self.test_fraction = 0.2\n\n        # folders\n        self.trainfolder = \"\"\n        self.folders = {}\n        self.currtraindata = []\n        self.currtestdata = []\n\n        # datasets\n        self.x_train, self.y_train = [], []\n        self.x_test, self.y_test = [], []\n\n        # model\n        self.clf = self._init_model()\n\n    # ----------------------------\n    # Model\n    # ----------------------------\n    def _init_model(self):\n        # TODO: Implement more models\n        return CatBoostClassifier(\n            iterations=self.iterations,\n            depth=6,\n            learning_rate=0.1,\n            loss_function=\"MultiClass\",\n            random_seed=self.random_state,\n            verbose=100,\n            early_stopping_rounds=20,\n        )\n\n    # ----------------------------\n    # Folder / Dataset Management\n    # ----------------------------\n    def _resolve_trainfolder(self, path):\n        if os.path.exists(path):\n            return path\n        candidate = os.path.join(self.get_current_dir(), path)\n        if not os.path.exists(candidate):\n            raise FileNotFoundError(f\"{path} folder not found\")\n        return candidate\n\n    def in_1_trainfolder(self, args):\n        self.trainfolder = self._resolve_trainfolder(args[0])\n        self.folders = {\n            f: os.path.join(self.trainfolder, f)\n            for f in os.listdir(self.trainfolder)\n            if os.path.isdir(os.path.join(self.trainfolder, f))\n        }\n        self.logpost(2, \"Train folder: \" + self.trainfolder)\n\n    # ----------------------------\n    # Audio processing\n    # ----------------------------\n    def _load_audio(self, filepath):\n        sr = pd.get_sample_rate()\n        y, _ = librosa.load(filepath, sr=sr)\n        return y\n\n    def _split_train_test(self, files):\n        n_test = max(1, int(len(files) * self.test_fraction))\n        test_files = random.sample(files, n_test)\n        train_files = [f for f in files if f not in test_files]\n        return train_files, test_files\n\n    def _generate_variants(self, y, sr, mode=\"traindata\"):\n        \"\"\"Retorna uma lista de vers\u00f5es do \u00e1udio (original + augmentadas se treino)\"\"\"\n        variants = [y]  # sempre inclui o original\n\n        if mode == \"traindata\":\n            # Exemplo: time stretch\n            value = random.uniform(0.7, 1.2)\n            variants.append(librosa.effects.time_stretch(y=y, rate=value))\n            value = random.uniform(0.7, 1.2)\n            variants.append(librosa.effects.time_stretch(y=y, rate=value))\n\n            # Exemplo: pitch shift\n            value = random.uniform(-2, 2)\n            variants.append(librosa.effects.pitch_shift(y=y, sr=sr, n_steps=value))\n            value = random.uniform(-2, 2)\n            variants.append(librosa.effects.pitch_shift(y=y, sr=sr, n_steps=value))\n\n            # Exemplo: adicionar ru\u00eddo\n            value = random.uniform(0.005, 0.009)\n            noise = np.random.normal(0, value, len(y))\n            variants.append(y + noise)\n\n        return variants\n\n    def _process_file(self, filepath, label, target_list, mode):\n        y = self._load_audio(filepath)\n        sr = pd.get_sample_rate()\n        variants = self._generate_variants(y, sr, mode=mode)\n\n        for signal in variants:\n            self._write_tab(signal)\n\n            idx = random.randint(0, 1024)\n            while True:\n                self.out(1, pd.LIST, [idx, mode])\n                if idx &gt;= len(signal) - 2048:\n                    break\n\n                if mode == \"testdata\":\n                    assert len(self.currtestdata) &gt; 0\n                    target_list.append((self.currtestdata, label))\n                    self.currtestdata = []\n                else:\n                    assert len(self.currtraindata) &gt; 0\n                    target_list.append((self.currtraindata, label))\n                    self.currtraindata = []\n\n                idx += random.randint(512, 1024)\n\n    def _write_tab(self, y):\n        self.redraw += 1\n\n        self.tabwrite(\n            \"train\",\n            y.tolist(),\n            resize=True,\n            redraw=(self.redraw % self.redraw_tab_after == 0),\n        )\n\n    # ----------------------------\n    # Dataset Build\n    # ----------------------------\n    def get_train_mir(self):\n        self.redraw = 0\n        train_data, test_data = [], []\n\n        for label, folder in self.folders.items():\n            self.logpost(2, f\"Processing {label}\")\n            all_files = [\n                os.path.join(folder, f)\n                for f in os.listdir(folder)\n                if f.endswith((\".aif\", \".aiff\", \".wav\"))\n            ]\n            train_files, test_files = self._split_train_test(all_files)\n\n            for f in test_files:\n                self._process_file(f, label, test_data, \"testdata\")\n\n            for f in train_files:\n                self._process_file(f, label, train_data, \"traindata\")\n\n        self.x_train, self.y_train = zip(*train_data) if train_data else ([], [])\n        self.x_test, self.y_test = zip(*test_data) if test_data else ([], [])\n\n        self.x_np_train = np.array(self.x_train)\n        self.y_np_train = np.array(self.y_train)\n        self.x_np_test = np.array(self.x_test)\n        self.y_np_test = np.array(self.y_test)\n\n        self.logpost(2, \"Done!\")\n\n    # ----------------------------\n    # Training / Export\n    # ----------------------------\n    def _train(self):\n        self.clf.fit(\n            self.x_np_train,\n            self.y_np_train,\n            eval_set=(self.x_np_test, self.y_np_test),\n        )\n        y_pred = self.clf.predict(self.x_np_test)\n        self.logpost(2, classification_report(self.y_np_test, y_pred), prefix=False)\n        self.logpost(2, \"\", prefix=False)\n        self.logpost(2, \"Training finished!\")\n\n    def in_0_train(self, args):\n        self.logpost(2, \"Training, wait...\")\n        t = threading.Thread(target=self._train, daemon=True)\n        t.start()\n\n    def in_0_export(self, args):\n        file = args[0]\n        path = os.path.join(self.get_current_dir(), file)\n        if os.path.exists(path):\n            self.logpost(1, \"Model already exists, will replace it!\")\n        self.clf.save_model(path, format=\"onnx\")\n        self.logpost(2, f\"Model exported to {path}\")\n\n    # ----------------------------\n    # Utils\n    # ----------------------------\n    def in_0_printdata(self, _):\n        self.logpost(2, f\"Train samples: {len(self.x_train)}\")\n        self.logpost(2, f\"Train labels: {len(self.y_train)}\")\n        assert len(self.x_train) == len(self.y_train)\n\n        self.logpost(2, f\"Test samples: {len(self.x_test)}\")\n        self.logpost(2, f\"Test labels: {len(self.y_test)}\")\n        assert len(self.x_test) == len(self.y_test)\n\n    def in_1_testdata(self, data):\n        self.currtestdata = data\n\n    def in_1_traindata(self, data):\n        self.currtraindata = data\n\n    def in_0_analyze(self, _):\n        t = threading.Thread(target=self.get_train_mir, daemon=True)\n        t.start()\n\n    def in_0_randomload(self, args):\n        all_files = [\n            os.path.join(folder, f)\n            for label, folder in self.folders.items()\n            for f in os.listdir(folder)\n            if f.endswith((\".aif\", \".aiff\"))\n        ]\n        if not all_files:\n            return None\n        random_file = random.choice(all_files)\n        y = self._load_audio(random_file)\n        self.tabwrite(\"train\", y.tolist(), resize=True)\n</code></pre> <p>For <code>patch</code> where I use this object and more info check pd-onnx. Inside the <code>resources</code> folder also this youtube example.</p>"},{"location":"libraries/","title":"External Libraries","text":"<p>In this page I list all the libraries with <code>py4pd</code> that I know. This, someday, hopefully, will be something like OpenMusic Libraries section OpenMusic Libraries.</p> <p>Check <code>py4pd</code> installation process here.</p>"},{"location":"libraries/#list-of-libraries","title":"List of Libraries","text":"<p>I am updating <code>py4pd</code>, please wait for this section to be updated.</p>"},{"location":"newobject/","title":"<code>NewObject</code> Class","text":"<p>All <code>py4pd</code> object classes are created from the base class <code>puredata.NewObject</code>. </p> <pre><code>import puredata as pd\n\nclass pymetro(pd.NewObject):\n    name: str = \"pymetro\" # object name, must be exactly the same as the file name (pymetro.pd_py)\n\n    def __init__(self, args):\n        # Object initializer\n        pass\n</code></pre>"},{"location":"openmusic/","title":"Algorithm Composition","text":"<p><code>py4pd</code> offers a list of objects to create algorithm composition, they mimic some obcjets of OpenMusic.</p> <p>I am yet implementing most of OpenMusic objects</p>"},{"location":"openmusic/#visual-language","title":"Visual Language","text":""},{"location":"openmusic/#lisp","title":"Lisp","text":"<p>Basic functions defined in the programming language</p> <ul> <li><code>py.first</code>: Returns the first element of a list.</li> <li><code>py.second</code>: Returns the second element of a list.</li> <li><code>py.third</code>: Returns the third element of a list.</li> <li><code>py.nth</code>: Returns the element at a specified index in a list.</li> <li><code>py.rest</code>: Returns all elements of a list except the first.</li> <li><code>py.nthcdr</code>: Returns all elements of a list starting from a specified index.</li> <li><code>py.butlast</code>: Returns all elements of a list except the last.</li> <li><code>py.reverse</code>: Returns a new list with elements in reverse order.</li> <li><code>py.length</code>: Returns the number of elements in a list.</li> <li><code>py.list</code>: Converts arguments into a list.</li> <li><code>py.remove</code>: Returns a list with all occurrences of a given element removed.</li> <li><code>py.cons</code>: Constructs a new list by prepending an element to an existing list.</li> <li><code>py.append</code>: Concatenates two lists into a single list.</li> <li><code>py.apply</code>: Calls a function with a list of arguments.</li> <li><code>py.funcall</code>: Calls a function with given arguments directly.</li> <li><code>py.mapcar</code>: Applies a function to each element of a list and returns a list of results.</li> <li><code>py.mapcan</code>: Applies a function to each element of a list and concatenates all results into a single list.</li> </ul>"},{"location":"openmusic/#control","title":"Control","text":"<p>Special boxes implementing control operators, argument passing and memory</p> <ul> <li><code>py.seq</code>:</li> <li><code>py.hub</code>:</li> <li><code>py.split</code>:</li> <li><code>py.default</code>:</li> </ul>"},{"location":"openmusic/#loop","title":"Loop","text":"<p>Special boxes for visual loop implementation</p> <p>Special symbols:</p> <ul> <li><code>py.iterate</code>: Iterate over a list.</li> <li><code>py.collect</code>: Collect items. Must work with <code>py.iterate</code>.</li> </ul>"},{"location":"openmusic/#basic-tools","title":"Basic Tools","text":"<p>Objects and tools for data representation and processing</p>"},{"location":"openmusic/#arithmetic","title":"Arithmetic","text":"<ul> <li><code>py.+</code>: + lists, number and list with number.</li> <li><code>py.-</code>: - lists, number and list with number.</li> <li><code>py.*</code>: * lists, number and list with number.</li> <li><code>py./</code>: / lists, number and list with number.</li> </ul>"},{"location":"pdmodule/","title":"Creating Objects (Pure Data module)","text":"<p>This page documents the actual Python API exported by py4pd's C core (see <code>Sources/py4pd.c</code>).</p> <p>If you want to create a new <code>py4pd</code> object, you write a Python file with the extension <code>.pd_py</code>, define a class that inherits from <code>puredata.NewObject</code>, and make sure the class <code>name</code> matches the filename.</p>"},{"location":"pdmodule/#quick-start","title":"Quick start","text":"<p>Create a file <code>mymetro.pd_py</code>:</p> <pre><code>import puredata as pd\n\n\nclass mymetro(pd.NewObject):\n    name: str = \"mymetro\"  # must match the filename (mymetro.pd_py)\n\n    def __init__(self, args):\n        self.inlets = 2\n        self.outlets = 1\n        self.ms = float(args[0]) if len(args) else 250.0\n        self.running = False\n        self.clock = pd.new_clock(self, self._tick)\n\n    def in_1_float(self, f: float):\n        self.running = bool(f)\n        if self.running:\n            self._tick()\n        else:\n            self.clock.unset()\n\n    def in_2_float(self, f: float):\n        self.ms = float(f)\n\n    def _tick(self):\n        if self.running:\n            self.clock.delay(self.ms)\n            self.out(0, pd.SYMBOL, \"tick\")\n</code></pre>"},{"location":"pdmodule/#how-pd-messages-map-to-python-methods","title":"How Pd messages map to Python methods","text":"<p><code>py4pd</code> routes incoming messages to methods using this naming convention:</p> <ul> <li><code>in_{INLET}_{SELECTOR}</code></li> </ul> <p>Where:</p> <ul> <li><code>INLET</code> is 1-based (first inlet is <code>1</code>, second is <code>2</code>, ...)</li> <li><code>SELECTOR</code> is the Pd selector name (<code>bang</code>, <code>float</code>, <code>symbol</code>, <code>list</code>, or any custom selector)</li> </ul>"},{"location":"pdmodule/#argument-conversion","title":"Argument conversion","text":"<p><code>py4pd</code> converts Pd atoms to Python values like this:</p> <ul> <li><code>bang</code> \u2192 calls <code>in_N_bang(self)</code> (no arguments)</li> <li><code>float</code> \u2192 calls <code>in_N_float(self, f: float)</code></li> <li><code>symbol</code> \u2192 calls <code>in_N_symbol(self, s: str)</code></li> <li><code>list</code> \u2192 calls <code>in_N_list(self, xs: list)</code></li> <li>numbers become <code>int</code> when possible, otherwise <code>float</code></li> <li>symbols become <code>str</code></li> <li>Any other selector (example: <code>set</code>, <code>foo</code>, <code>bar</code>) \u2192 calls <code>in_N_set(self, args: list)</code></li> <li>the single argument is a Python <code>list</code> of the message atoms (same conversion rules)</li> </ul>"},{"location":"pdmodule/#methods-must-return-none","title":"Methods must return <code>None</code>","text":"<p>If your method returns anything other than <code>None</code>, <code>py4pd</code> will print an error in Pd. Use <code>self.out(...)</code> to output values.</p>"},{"location":"pdmodule/#inlets-and-outlets","title":"Inlets and outlets","text":"<p>In <code>__init__</code>, set <code>self.inlets</code> and <code>self.outlets</code>.</p> <p>These attributes can be:</p>"},{"location":"pdmodule/#1-an-integer-count","title":"1) An integer (count)","text":"<pre><code>self.inlets = 2\nself.outlets = 3\n</code></pre>"},{"location":"pdmodule/#2-a-single-string-one-inletoutlet","title":"2) A single string (one inlet/outlet)","text":"<p>Use the module constants:</p> <ul> <li><code>pd.SIGNAL</code> (string: <code>\"signal\"</code>)</li> <li><code>pd.DATA</code> (string: <code>\"anything\"</code>)</li> </ul> <p>Example:</p> <pre><code>self.inlets = pd.SIGNAL\nself.outlets = pd.SIGNAL\n</code></pre>"},{"location":"pdmodule/#3-a-tuple-of-strings-typed-configuration","title":"3) A tuple of strings (typed configuration)","text":"<pre><code>self.inlets = (pd.SIGNAL, pd.DATA, pd.DATA)\nself.outlets = (pd.DATA, pd.SIGNAL)\n</code></pre>"},{"location":"pdmodule/#output-from-python-to-pd-selfout","title":"Output from Python to Pd: <code>self.out</code>","text":"<p>Use:</p> <pre><code>self.out(outlet_index, type_constant, value)\n</code></pre> <p>Type constants exported by the module:</p> <ul> <li><code>pd.FLOAT</code></li> <li><code>pd.SYMBOL</code></li> <li><code>pd.LIST</code></li> <li><code>pd.PYOBJECT</code></li> </ul> <p>Examples:</p> <pre><code>self.out(0, pd.FLOAT, 1.5)\nself.out(0, pd.SYMBOL, \"hello\")\nself.out(0, pd.LIST, [1, 2, 3, \"a\"])\n</code></pre>"},{"location":"pdmodule/#passing-arbitrary-python-objects-pdpyobject","title":"Passing arbitrary Python objects (<code>pd.PYOBJECT</code>)","text":"<p>You can send arbitrary Python objects between <code>py4pd</code> objects using <code>pd.PYOBJECT</code>.</p> <p>Sender:</p> <pre><code>self.out(0, pd.PYOBJECT, {\"a\": 1, \"b\": 2})\n</code></pre> <p>Receiver: implement <code>in_N_pyobj</code>:</p> <pre><code>def in_1_pyobj(self, obj):\n    # obj is the exact Python object that was sent\n    self.logpost(2, \"Got:\", obj)\n</code></pre>"},{"location":"pdmodule/#arrays-pd-tables-tabread-tabwrite","title":"Arrays (Pd tables): <code>tabread</code> / <code>tabwrite</code>","text":"<p>Read an array as a Python tuple of floats:</p> <pre><code>data = self.tabread(\"myarray\")\n</code></pre> <p>Write a list/tuple of numbers into an array:</p> <pre><code>self.tabwrite(\"myarray\", [0.0, 0.5, 1.0])\n</code></pre> <p>Options:</p> <ul> <li><code>resize=True</code> to resize the Pd array to fit the input length</li> <li><code>redraw=False</code> to skip GUI redraw (useful for performance)</li> </ul> <pre><code>self.tabwrite(\"myarray\", [0.0, 0.5, 1.0], resize=True, redraw=True)\n</code></pre>"},{"location":"pdmodule/#logging-and-errors","title":"Logging and errors","text":""},{"location":"pdmodule/#selflogpostloglevel-args-prefixtrue","title":"<code>self.logpost(loglevel, *args, prefix=True)</code>","text":"<p>Posts to the Pd console. <code>loglevel</code> is an integer (Pd uses levels like error/log/debug depending on your build and settings).</p> <pre><code>self.logpost(2, \"processing\", 123)\nself.logpost(2, \"no prefix\", prefix=False)\n</code></pre>"},{"location":"pdmodule/#selferrorargs","title":"<code>self.error(*args)</code>","text":"<p>Prints an error tagged with the object name:</p> <pre><code>self.error(\"Something went wrong\")\n</code></pre>"},{"location":"pdmodule/#helpers","title":"Helpers","text":"<ul> <li><code>self.get_current_dir()</code> \u2192 returns the current canvas directory (string)</li> <li><code>self.reload()</code> \u2192 reloads the current <code>.pd_py</code> file and updates the running object</li> </ul>"},{"location":"pdmodule/#clocks-timers","title":"Clocks (timers)","text":"<p>Create a clock:</p> <pre><code>self.clock = pd.new_clock(self, self._tick)\n</code></pre> <p>Supported clock methods:</p> <ul> <li><code>clock.delay(ms: float)</code> schedule the callback after <code>ms</code> milliseconds</li> <li><code>clock.unset()</code> cancel any pending callback</li> </ul> <p>Note: the C core also defines a <code>set(...)</code> method on the clock type, but <code>delay(...)</code> and <code>unset()</code> are the stable, expected API.</p>"},{"location":"pdmodule/#receivers-global-symbol-binding","title":"Receivers (global symbol binding)","text":"<p>Bind to a Pd symbol so you can receive messages sent to it:</p> <pre><code>self.r = pd.new_receiver(self, \"mysym\", self.received)\n\ndef received(self, x):\n    self.logpost(2, \"got\", x)\n</code></pre> <p>The callback receives arguments using the same conversion rules as inlet methods (<code>bang</code>/<code>float</code>/<code>symbol</code>/<code>list</code>/other).</p> <p>Implementation note: the current C core binds on creation and unbinds when the receiver object is destroyed; it does not currently expose explicit <code>bind()</code>/<code>unbind()</code> methods in Python.</p>"},{"location":"pdmodule/#audio-tilde-objects","title":"Audio (tilde) objects","text":"<p>If your class defines a callable <code>perform(...)</code>, <code>py4pd</code> registers it as a DSP object. For DSP to actually run, your class must also define a callable <code>dsp(sr, blocksize, inchans)</code> method that returns a boolean.</p>"},{"location":"pdmodule/#dspsr-blocksize-inchans-bool","title":"<code>dsp(sr, blocksize, inchans) -&gt; bool</code>","text":"<ul> <li><code>sr</code>: sample rate (float)</li> <li><code>blocksize</code>: block size (int)</li> <li><code>inchans</code>: number of signal inlets (int)</li> </ul> <p>Return <code>True</code> to enable DSP, <code>False</code> to disable (outputs will be zeroed).</p>"},{"location":"pdmodule/#performinputs-tuple","title":"<code>perform(inputs) -&gt; tuple</code>","text":"<ul> <li><code>inputs</code> is a tuple of <code>inchans</code> Python lists, each list with <code>blocksize</code> floats</li> </ul> <p>Return:</p> <ul> <li>for 1 signal outlet: a tuple of <code>blocksize</code> floats</li> <li>for N signal outlets: a tuple of N tuples, each <code>blocksize</code> floats</li> </ul> <p>Example (1-in / 1-out):</p> <pre><code>import puredata as pd\nimport math\n\n\nclass pysine(pd.NewObject):\n    name = \"pysine~\"\n\n    def __init__(self, args):\n        self.inlets = pd.SIGNAL\n        self.outlets = pd.SIGNAL\n        self.phase = 0.0\n\n    def dsp(self, sr, blocksize, inchans):\n        self.sr = float(sr)\n        self.blocksize = int(blocksize)\n        return True\n\n    def perform(self, inputs):\n        freq = inputs[0]\n        out = []\n        for f in freq:\n            self.phase += (2.0 * math.pi * float(f)) / self.sr\n            if self.phase &gt; 2.0 * math.pi:\n                self.phase -= 2.0 * math.pi\n            out.append(math.sin(self.phase))\n        return tuple(out)\n</code></pre>"},{"location":"puredata-api/","title":"<code>puredata</code> Python API of <code>py4pd</code>","text":"<p>This page is a reference for the use of the <code>puredata</code> module in <code>py4pd</code> objects.</p> <p>If you are writing <code>.pd_py</code> objects, you typically:</p> <ul> <li><code>import puredata</code></li> <li>create a subclass inherent of <code>puredata.NewObject</code></li> <li>implement inlet methods like <code>in_0_float(...)</code></li> </ul> <p>The object below reproduces the behavior of the Pure Data <code>metro</code> object.</p> <pre><code>import puredata as pd\n\nclass pymetro(pd.NewObject):\n    name: str = \"pymetro\"\n\n    def __init__(self, args):\n        self.inlets = 2\n        self.outlets = 1\n        self.toggle = False\n        if len(args) &gt; 0:\n            self.time = float(args[0])\n        else:\n            self.time = 1000\n        self.metro = pd.new_clock(self, self.tick)\n        self.args = args\n\n    def in_1_float(self, f: float):\n        self.time = f\n\n    def in_0_float(self, f: float):\n        if f:\n            self.toggle = True\n            self.tick()\n        else:\n            self.metro.unset()\n            self.toggle = False\n\n    def in_0_reload(self, args: list):\n        self.reload()\n\n    def tick(self):\n        if self.toggle:\n            self.metro.delay(self.time)\n        self.out(0, pd.SYMBOL, \"test238\")\n</code></pre>"},{"location":"puredata-api/#constants","title":"Constants","text":""},{"location":"puredata-api/#output-type-constants","title":"Output type constants","text":"<ul> <li><code>puredata.FLOAT</code> (Pd <code>A_FLOAT</code>)</li> <li><code>puredata.SYMBOL</code> (Pd <code>A_SYMBOL</code>)</li> <li><code>puredata.LIST</code> (Pd <code>A_GIMME</code>)</li> <li><code>puredata.PYOBJECT</code> (output Python Objects for Pd)</li> </ul> <p>This is used inside methods like <code>self.out</code> and <code>puredata.send</code>.</p>"},{"location":"puredata-api/#inlets-types-constants","title":"Inlets types constants","text":"<ul> <li><code>puredata.SIGNAL</code>, relative to <code>&amp;s_signal</code>;</li> <li><code>puredata.DATA</code>, relative to <code>&amp;s_anything</code>;</li> </ul> <p>Used to create objects for signal processing. Default is always <code>puredata.DATA</code>. For example:</p> <pre><code>import puredata as pd\n\nclass pydsp(pd.NewObject):\n    name: str = \"pydsp\"\n\n    def __init__(self, args):\n        self.inlets = 2\n        self.outlets = (pd.SIGNAL, pd.SIGNAL, pd.DATA)\n</code></pre> <p>In this object, we have 2 <code>pd.DATA</code> inlets and 3 outlets. First 2 outlets are <code>pd.SIGNAL</code> (audio) and the last one is a <code>pd.DATA</code>.</p>"},{"location":"puredata-api/#puredata-global-methods","title":"<code>puredata</code> global methods","text":""},{"location":"puredata-api/#puredatapost","title":"<code>puredata.post</code>","text":"<ul> <li><code>puredata.post(*args) -&gt; bool</code></li> </ul> <p>Posts a message to the Pd console (not rastreable), </p>"},{"location":"puredata-api/#puredatahasgui","title":"<code>puredata.hasgui</code>","text":"<ul> <li><code>puredata.hasgui() -&gt; bool</code></li> </ul> <p>Returns <code>True</code> when Pd is running with a GUI.</p>"},{"location":"puredata-api/#puredataget_sample_rate","title":"<code>puredata.get_sample_rate</code>","text":"<ul> <li><code>puredata.get_sample_rate() -&gt; int</code></li> </ul> <p>Returns Pd sample rate.</p>"},{"location":"puredata-api/#time-inside-py4pd","title":"Time inside py4pd","text":""},{"location":"puredata-api/#puredatanew_clock","title":"<code>puredata.new_clock</code>","text":"<ul> <li><code>puredata.new_clock(owner, callback) -&gt; puredata.clock</code></li> </ul> <p>Creates a Pd clock owned by <code>owner</code> (<code>self</code>). When it fires it calls <code>callback()</code>.</p>"},{"location":"puredata-api/#puredataclockdelay","title":"<code>puredata.clock.delay</code>","text":"<p>Schedule <code>callback()</code> after <code>ms</code> milliseconds.</p>"},{"location":"puredata-api/#puredataclockunset","title":"<code>puredata.clock.unset</code>","text":"<ul> <li><code>puredata.clock.unset() -&gt; bool</code></li> </ul> <p>Cancel any scheduled callback.</p>"},{"location":"puredata-api/#puredataclockset","title":"<code>puredata.clock.set</code>","text":"<ul> <li><code>puredata.clock.set(time: float) -&gt; bool</code></li> </ul> <p>Schedule clock for an absolute systime. <code>True</code> on sucess.</p> <p>Check the use with clock <code>pymetro</code></p> <pre><code>    def __init__(self, args):\n        self.inlets = 2\n        self.outlets = 1\n        self.time = 1000\n        self.metro = pd.new_clock(self, self.tick)\n        self.args = args\n\n    def in_0_float(self, f: float):\n        if f:\n            self.toggle = True\n            self.tick()\n        else:\n            self.metro.unset()\n            self.toggle = False\n\n    def in_0_reload(self, args: list):\n        self.reload()\n\n    def tick(self):\n        if self.toggle:\n            self.metro.delay(self.time)\n</code></pre>"},{"location":"puredata-api/#receivers-in-py4pd","title":"Receivers in py4pd","text":""},{"location":"puredata-api/#puredatanew_receiver","title":"<code>puredata.new_receiver</code>","text":"<ul> <li><code>puredata.new_receiver(owner, symbol: str, callback) -&gt; puredata.receiver</code></li> </ul> <p>Binds to <code>symbol</code> (global Pd symbol) and forwards incoming messages to <code>callback</code>.</p> <pre><code>    def __init__(self, args):\n        self.inlets = 0\n        self.outlets = 1\n        self.receiver = pd.new_receiver(self, \"myreceiver\", self.tick)\n\n    def tick(self, args):\n        self.logpost(1, \"Received something\")\n</code></pre>"},{"location":"puredata-api/#class-puredatanewobject","title":"Class: <code>puredata.NewObject</code>","text":"<p>Main class to create a python object with <code>py4pd</code></p> <p>Your <code>.pd_py</code> object class must inherit from <code>puredata.NewObject</code>.</p>"},{"location":"puredata-api/#constructor","title":"Constructor","text":"<p><code>puredata.NewObject</code></p> <p>The C core uses this to ensure the module-level registry exists. In practice, you just need to define a class that is inherit of this.</p> <pre><code>import puredata as pd\n\nclass pymetro(pd.NewObject):\n    name: str = \"pymetro\"  # Name of the Pure Data object\n\n    def __init__(self, args):\n        self.inlets = 2    # Number of inlets\n        self.outlets = 1   # Number of outlets\n</code></pre>"},{"location":"puredata-api/#methods-available-on-your-object-instance","title":"Methods (available on your object instance)","text":""},{"location":"puredata-api/#selfout","title":"<code>self.out</code>","text":"<ul> <li><code>self.out(outlet: int, type: int, value) -&gt; bool</code></li> </ul> <p>Send data to a Pd outlet.</p> <ul> <li><code>type</code> must be one of: <code>puredata.FLOAT</code>, <code>puredata.SYMBOL</code>, <code>puredata.LIST</code>, <code>puredata.PYOBJECT</code></li> <li>Outlet is 0-based (left -&gt; right).</li> </ul> <p><code>self.out</code> is 1-based</p> <p>Behavior:</p> <ul> <li><code>FLOAT</code>: converts <code>value</code> to float and outputs a Pd float</li> <li><code>SYMBOL</code>: converts <code>value</code> to string and outputs a Pd symbol</li> <li><code>LIST</code>: requires a Python <code>list</code> of numbers/strings</li> <li><code>PYOBJECT</code>: sends an internal pointer token so another py4pd object can receive the original Python object via <code>in_N_pyobj</code></li> </ul>"},{"location":"puredata-api/#selftabread","title":"<code>self.tabread</code>","text":"<p><code>self.tabread(name: str) -&gt; tuple[float, ...]</code></p> <p>Read a Pd array (<code>garray</code>) into a Python tuple.</p>"},{"location":"puredata-api/#selftabwrite","title":"<code>self.tabwrite</code>","text":"<ul> <li><code>self.tabwrite(name: str, data: list|tuple, resize=False, redraw=True) -&gt; bool</code></li> </ul> <p>Write Python numeric data into a Pd array.</p> <ul> <li><code>resize=True</code> will resize the Pd array to match input length</li> <li><code>redraw=False</code> skips GUI redraw (useful for performance)</li> </ul>"},{"location":"puredata-api/#selfget_current_dir","title":"<code>self.get_current_dir</code>","text":"<ul> <li><code>self.get_current_dir() -&gt; str | None</code></li> </ul> <p>Returns the directory of the current canvas. Where is the patch in which the current object is located.</p>"},{"location":"puredata-api/#selfreload","title":"<code>self.reload</code>","text":"<ul> <li><code>self.reload() -&gt; bool</code></li> </ul> <p>Reloads the current <code>.pd_py</code> source file and swaps the running class instance.</p>"},{"location":"puredata-api/#selflogpost","title":"<code>self.logpost</code>","text":"<ul> <li><code>self.logpost(loglevel: int, *args, prefix=True) -&gt; bool</code></li> </ul> <p>Posts a log message to the Pd console.</p> <ul> <li><code>prefix=True</code> prints <code>[{object_name}]: ...</code>.</li> </ul>"},{"location":"puredata-api/#selferror","title":"<code>self.error</code>","text":"<ul> <li><code>self.error(*args) -&gt; bool</code></li> </ul> <p>Prints an error tagged with the object name.</p>"},{"location":"puredata-api/#inlet-callback-naming-pd-python","title":"Inlet callback naming (Pd \u2192 Python)","text":"<p>The message dispatcher in <code>py4pd.c</code> looks for methods named:</p> <ul> <li><code>in_{INLET_INDEX}_{SELECTOR}</code></li> </ul> <p>Where <code>INLET_INDEX</code> is 0-based (left -&gt; right).</p> <p>Common selectors:</p> <ul> <li><code>bang</code> \u2192 <code>in_0_bang(self)</code></li> <li><code>float</code> \u2192 <code>in_0_float(self, f)</code></li> <li><code>symbol</code> \u2192 <code>in_0_symbol(self, s)</code></li> <li><code>list</code> \u2192 <code>in_0_list(self, xs)</code></li> <li>any other selector (e.g. <code>set</code>) \u2192 <code>in_0_set(self, args)</code></li> </ul> <p>To receive Python objects sent with <code>puredata.PYOBJECT</code> implement:</p> <ul> <li><code>in_{INLET_INDEX}_pyobj(self, obj)</code></li> </ul>"},{"location":"setup-libs/","title":"Setup libs","text":"<p>After creating objects with <code>py4pd</code>, you can add them to a library and install it using <code>pip</code> or the <code>py.pip</code> interface provided by <code>py4pd</code>. The process is straightforward: create a new GitHub repository and include a <code>pyproject.toml</code> file. This will make the library accessible within <code>py4pd</code>. Below is a simple example:</p> <pre><code>[project]\nname = \"py4pd-upic\"\nversion = \"0.1.0\"\ndescription = \"Description.\"\ndependencies = [\n    \"svgpathtools\",\n]\n\n[project.urls]\n\"Source Code\" = \"https://github.com/username/package\" \n\n[tool.setuptools]\npackages = [\"mypackage\"]  # Name of the package to be imported\n\n# to use subfolders\n#\"mypackage\" = [\"*\", \"othersfiles/*\"]  \n</code></pre> <p>TODO: Needs updates</p>"},{"location":"setup/","title":"First Install <code>Python</code>","text":"<p>Always check if the Python version you install is the right one!</p>  macOS Windows Linux <p>On <code>MacOS</code> you can install Python as an ordinary software.</p> <ul> <li>Go to Python.org,</li> <li>Go to the bottom of the page and download: <code>macOS 64-bit universal2 installer</code>.</li> <li>Install it as an ordinary program.</li> </ul> <p>On <code>Windows</code> you can install Python as an ordinary software.</p> <ul> <li>Go to Python.org,</li> <li>Go to the bottom of the page and download: <code>Windows installer (64-bit)</code>.</li> <li>Install it as an ordinary program.</li> </ul> <p>Be careful of conflicts with numpy installed on the system</p> <p>Sometimes, if numpy is already installed on your system (with the same version), <code>py4pd</code> may not work. This is a known limitation, and I haven't found a solution for it yet besides uninstall numpy from the system. Be carefull.</p> <p>On <code>Linux</code>:</p> <ul> <li>Open the terminal.</li> <li>Run:<ul> <li> <code>sudo dnf install python3.12 python3-pip</code></li> <li> <code>sudo apt install python3.12 python3-pip</code></li> <li> <code>sudo yay -S python312 python3.pip</code></li> </ul> </li> </ul>"},{"location":"setup/#after-install-py4pd","title":"After Install <code>py4pd</code>","text":"<ol> <li>Open PureData,</li> <li>Go to <code>Help-&gt;Find Externals-&gt;</code>,</li> <li>Search for <code>py4pd</code>,</li> <li>Select py4pd and click on <code>Install</code>:</li> </ol> Process of install py4pd on PureData"},{"location":"setup/#extra-info","title":"Extra Info","text":"<p>To use <code>py4pd</code>, besides PureData, you always need to install Python and the package <code>py4pd</code>. I recommend to install Python first then the <code>py4pd</code> package.</p> <p>Warning</p> <p>Always use the right version of Python as showed in the table.</p> <p> Py4pd Version Python Version <code>1.1.0</code> Python 3.14 <code>1.0.0</code> Python 3.13 <code>0.9.0</code> Python 3.12 <code>0.8.0</code> Python 3.11 </p>"}]}